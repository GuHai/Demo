<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.yskj.dao.ApplySettlementDao" ><!-- 查询字段 --><sql id="columnList" >	a.id,a.workDate,a.state,a.attachmentId,a.signIDS,	 a.applyPay, a.applyReason, a.userID, a.positionID, a.handleOpinion, a.reason, a.createBy, a.createTime, a.updateBy, a.updateTime, a.version, a.isDeleted</sql><!--通过id集合in查询--><sql id="inClause">    <if test="column!=null">        <if test="ids==null">            and 1=0        </if>        <if test="ids!=null">            <if test="ids.size>0">                and  a.${column} in                <foreach item="items" index="index" collection="ids" open="(" separator="," close=")">                    #{items}                </foreach>            </if>            <if test="ids.size==0">                and 1=0            </if>        </if>    </if></sql><!-- 查询条件 --><sql id="whereClause">where 1=1<trim  suffixOverrides="," >	<if test="condition.id != null" >	    and a.id = #{condition.id}	</if>	<if test="condition.applyPay != null" >and  a.applyPay = #{condition.applyPay}</if><if test="condition.applyReason != null" >and  a.applyReason = #{condition.applyReason}</if><if test="condition.userID != null" >and  a.userID = #{condition.userID}</if><if test="condition.positionID != null" >and  a.positionID = #{condition.positionID}</if><if test="condition.handleOpinion != null" >and  a.handleOpinion = #{condition.handleOpinion}</if><if test="condition.reason != null" >and  a.reason = #{condition.reason}</if><if test="condition.createBy != null" >and  a.createBy = #{condition.createBy}</if><if test="condition.createTime != null" >and  a.createTime = #{condition.createTime}</if><if test="condition.updateBy != null" >and  a.updateBy = #{condition.updateBy}</if><if test="condition.updateTime != null" >and  a.updateTime = #{condition.updateTime}</if><if test="condition.version != null" >and  a.version = #{condition.version}</if><if test="condition.isDeleted != null" >and  a.isDeleted = #{condition.isDeleted}</if>	<if test="condition.workDate != null" >and  a.workDate = #{condition.workDate}</if>	<if test="condition.state != null" >and  a.state = #{condition.state}</if></trim><include refid="inClause"/></sql><!-- 模糊查询条件 --><sql id="whereLikeClause">where 1=1<trim  suffixOverrides="," >	<if test="condition.id != null" >	    and a.id = #{condition.id}	</if>													 			<if test="condition.applyPay != null" >and  UPPER(a.applyPay) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.applyPay}),'%'))</if><if test="condition.applyReason != null" >and  UPPER(a.applyReason) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.applyReason}),'%'))</if><if test="condition.userID != null" >and  UPPER(a.userID) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.userID}),'%'))</if><if test="condition.positionID != null" >and  UPPER(a.positionID) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.positionID}),'%'))</if><if test="condition.handleOpinion != null" >and  UPPER(a.handleOpinion) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.handleOpinion}),'%'))</if><if test="condition.reason != null" >and  UPPER(a.reason) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.reason}),'%'))</if><if test="condition.createBy != null" >and  UPPER(a.createBy) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.createBy}),'%'))</if><if test="condition.createTime != null" >and  UPPER(a.createTime) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.createTime}),'%'))</if><if test="condition.updateBy != null" >and  UPPER(a.updateBy) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.updateBy}),'%'))</if><if test="condition.updateTime != null" >and  UPPER(a.updateTime) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.updateTime}),'%'))</if><if test="condition.version != null" >and  UPPER(a.version) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.version}),'%'))</if><if test="condition.isDeleted != null" >and  UPPER(a.isDeleted) LIKE   UPPER(CONCAT(CONCAT('%',#{condition.isDeleted}),'%'))</if>	<if test="condition.workDate != null" >and  a.workDate = #{condition.workDate}</if>	<if test="condition.state != null" >and  a.state = #{condition.state}</if></trim><include refid="inClause"/></sql><!-- 插入记录 --><insert id="add"  >  insert into applySettlement (id,signIDS,attachmentId,state,workDate,applyPay,applyReason,userID,positionID,handleOpinion,reason,createBy,createTime,updateBy,updateTime,version,isDeleted)  values(#{id,jdbcType=VARCHAR},#{signIDS},#{attachmentId},#{state},#{workDate},#{applyPay},#{applyReason},#{userID},#{positionID},#{handleOpinion},#{reason},#{createBy},#{createTime},#{updateBy},#{updateTime},#{version},#{isDeleted})</insert><!-- 修改记录，只修改只不为空的字段 --><update id="update" >	update applySettlement set	<trim  suffixOverrides="," >	<if test="applyPay != null ">applyPay=#{applyPay},</if><if test="applyReason != null ">applyReason=#{applyReason},</if><if test="userID != null ">userID=#{userID},</if><if test="positionID != null ">positionID=#{positionID},</if><if test="handleOpinion != null ">handleOpinion=#{handleOpinion},</if><if test="reason != null ">reason=#{reason},</if><if test="createBy != null ">createBy=#{createBy},</if><if test="createTime != null ">createTime=#{createTime},</if><if test="updateBy != null ">updateBy=#{updateBy},</if><if test="updateTime != null ">updateTime=#{updateTime},</if><if test="version != null ">version=#{version},</if><if test="isDeleted != null ">isDeleted=#{isDeleted},</if>		<if test="workDate != null ">workDate=#{workDate},</if>        <if test="signIDS != null ">signIDS=#{signIDS},</if>        <if test="state != null ">state=#{state},</if>		<if test="attachmentId != null ">attachmentId=#{attachmentId},</if>	</trim> where id=#{id} and version = #{version}-1</update><!-- 删除记录 --><delete id="del" >	delete from applySettlement where id = #{id}</delete><!-- 根据id查询  --><select id="get"   resultType="ApplySettlement"  parameterType="String">	select <include refid="columnList" /> 	from applySettlement  a	where  a.id = #{id}  and a.isDeleted = false</select><!-- 列表总数--><select id="count" resultType="java.lang.Long" >	select count(1) 	from applySettlement  a	<include refid="whereClause"/></select><!-- 查询page --><select id="findPage" resultType="ApplySettlement" >	select 	<include refid="columnList"/>	from applySettlement a	<include refid="whereClause"/>	<if test="orderByClause!=null">${orderByClause}</if></select><!-- 模糊查询page --><select id="findLikePage" resultType="ApplySettlement" >	select 	<include refid="columnList"/>	from applySettlement a	<include refid="whereLikeClause"/>	<if test="orderByClause!=null">${orderByClause}</if></select><!-- 查询列表list --><select id="findList" resultType="ApplySettlement" >	select	<include refid="columnList"/>,    IFNULL(user.realName,user.nickName) as 'name'	from applySettlement a left join shiro_user user on user.id= a.userID	<include refid="whereClause"/>	<if test="orderByClause!=null">${orderByClause}</if></select><!--模糊查询list--><select id="findLikeList" resultType="ApplySettlement" >	select	<include refid="columnList"/>	from applySettlement a	<include refid="whereLikeClause"/>	<if test="orderByClause!=null">${orderByClause}</if></select><!-- 查询符合条件的数据的id集合 --><select id="findIds" resultType="String">	select a.${idsColumn}	from applySettlement a    <include refid="whereClause"/>    <if test="orderByClause!=null">${orderByClause}</if></select><!-- 查询符合模糊条件的数据的id集合 --><select id="findLikeIds" resultType="String">	select a.${idsColumn}	from applySettlement a    <include refid="whereLikeClause"/>    <if test="orderByClause!=null">${orderByClause}</if></select><!-- 获取一个对象通过非id --><select id="one" resultType="ApplySettlement" >     select    <include refid="columnList"/>     from applySettlement a    <include refid="whereClause"/>    <if test="orderByClause!=null">${orderByClause}</if>    limit 0,1</select><!--如果你想返回一个HashMap 就实现这个select标签--><select id="queryHashMap" resultType="java.util.HashMap"  parameterType="Object"></select>    <!--级联查询-->    <sql id="detailList">        p.id as 'id',        p.version as 'version',p.title as 'title',p.salaryType as 'salaryType',p.recruitStartTime as 'recruitStartTime',p.recruitEndTime as 'recruitEndTime',p.salary as 'salary',p.dailySalary as 'dailySalary',p.liquidatedDamages as 'liquidatedDamages',p.recruitsSum as 'recruitsSum',p.sexRequirements as 'sexRequirements',p.workPalce as 'workPalce',p.workDate as 'workDate',p.aggregate as 'aggregate',p.setDate as 'setDate',p.contacts as 'contacts',p.contactNumber as 'contactNumber',p.settlement as 'settlement',p.matters as 'matters',p.jobRequirements as 'jobRequirements',p.jobContent as 'jobContent',p.includeBoard as 'includeBoard',p.controlSleep as 'controlSleep',p.interview as 'interview',p.baseTask as 'baseTask',p.commission as 'commission',p.train as 'train',p.beenRecruitedSum as 'beenRecruitedSum',p.workTypeID as 'workTypeID',p.userID as 'userID',p.open as 'open',p.type as 'type',p.startTime as 'startTime',p.endTime as 'endTime',        workPlace.id as 'workPlace.id',        workPlace.version as 'workPlace.version',workPlace.cityID as 'workPlace.cityID',workPlace.detailedAddress as 'workPlace.detailedAddress',workPlace.longitude as 'workPlace.longitude',workPlace.latitude as 'workPlace.latitude',        huntingtype.id as 'huntingtype.id',        huntingtype.version as 'huntingtype.version',huntingtype.name as 'huntingtype.name',huntingtype.HTFatCode as 'huntingtype.HTFatCode',huntingtype.state as 'huntingtype.state',huntingtype.codeGrade as 'huntingtype.codeGrade',        applySettlementList.id as 'applySettlementList.id',        applySettlementList.version as 'applySettlementList.version',applySettlementList.applyPay as 'applySettlementList.applyPay',applySettlementList.applyReason as 'applySettlementList.applyReason',applySettlementList.userID as 'applySettlementList.userID',applySettlementList.positionID as 'applySettlementList.positionID',applySettlementList.handleOpinion as 'applySettlementList.handleOpinion',applySettlementList.reason as 'applySettlementList.reason',applySettlementList.workDate as 'applySettlementList.workDate',applySettlementList.state as 'applySettlementList.state',        user.id as 'applySettlementList.user.id',        user.version as 'applySettlementList.user.version',user.accountNo as 'applySettlementList.user.accountNo',user.password as 'applySettlementList.user.password',user.weChatNo as 'applySettlementList.user.weChatNo',user.nickName as 'applySettlementList.user.nickName',user.sex as 'applySettlementList.user.sex',user.phoneNumber as 'applySettlementList.user.phoneNumber',user.lastLoginTime as 'applySettlementList.user.lastLoginTime',user.loginTime as 'applySettlementList.user.loginTime',user.status as 'applySettlementList.user.status',user.realName as 'applySettlementList.user.realName',user.IDCard as 'applySettlementList.user.IDCard',user.infoHeadImg as 'applySettlementList.user.infoHeadImg',user.locked as 'applySettlementList.user.locked',user.userSig as 'applySettlementList.user.userSig',user.birthday as 'applySettlementList.user.birthday',        attachmentUser.id as 'applySettlementList.user.attachment.id',        attachmentUser.version as 'applySettlementList.user.attachment.version',attachmentUser.datestr as 'applySettlementList.user.attachment.datestr',attachmentUser.path as 'applySettlementList.user.attachment.path',attachmentUser.name as 'applySettlementList.user.attachment.name',attachmentUser.title as 'applySettlementList.user.attachment.title',attachmentUser.type as 'applySettlementList.user.attachment.type',attachmentUser.refID as 'applySettlementList.user.attachment.refID',        weixin.headimgurl as 'user.weixin.headimgurl',        attachmentApply.id as 'applySettlementList.attachment.id',        attachmentApply.version as 'applySettlementList.attachment.version',attachmentApply.datestr as 'applySettlementList.attachment.datestr',attachmentApply.path as 'applySettlementList.attachment.path',attachmentApply.name as 'applySettlementList.attachment.name',attachmentApply.title as 'applySettlementList.attachment.title',attachmentApply.type as 'applySettlementList.attachment.type',attachmentApply.refID as 'applySettlementList.attachment.refID'    </sql>    <!--Localtioninfo映射-->    <resultMap id="LocaltioninfoMap" type="Localtioninfo">        <id property="id" column="workPlace.id" />        <result property="version" column="workPlace.version" />        <result property="cityID" column="workPlace.cityID" />        <result property="detailedAddress" column="workPlace.detailedAddress" />        <result property="longitude" column="workPlace.longitude" />        <result property="latitude" column="workPlace.latitude" />    </resultMap>    <!--Huntingtype映射-->    <resultMap id="HuntingtypeMap" type="Huntingtype">        <id property="id" column="huntingtype.id" />        <result property="version" column="huntingtype.version" />        <result property="name" column="huntingtype.name" />        <result property="HTFatCode" column="huntingtype.HTFatCode" />        <result property="state" column="huntingtype.state" />        <result property="codeGrade" column="huntingtype.codeGrade" />    </resultMap>    <!--Attachment映射-->    <resultMap id="UserAttachmentMap" type="Attachment">        <id property="id" column="applySettlementList.user.attachment.id" />        <result property="version" column="applySettlementList.user.attachment.version" />        <result property="datestr" column="applySettlementList.user.attachment.datestr" />        <result property="path" column="applySettlementList.user.attachment.path" />        <result property="name" column="applySettlementList.user.attachment.name" />        <result property="title" column="applySettlementList.user.attachment.title" />        <result property="type" column="applySettlementList.user.attachment.type" />        <result property="refID" column="applySettlementList.user.attachment.refID" />    </resultMap>    <!--User映射-->    <resultMap id="UserMap" type="User">        <id property="id" column="applySettlementList.user.id" />        <result property="version" column="applySettlementList.user.version" />        <result property="accountNo" column="applySettlementList.user.accountNo" />        <result property="password" column="applySettlementList.user.password" />        <result property="weChatNo" column="applySettlementList.user.weChatNo" />        <result property="nickName" column="applySettlementList.user.nickName" />        <result property="sex" column="applySettlementList.user.sex" />        <result property="phoneNumber" column="applySettlementList.user.phoneNumber" />        <result property="lastLoginTime" column="applySettlementList.user.lastLoginTime" />        <result property="loginTime" column="applySettlementList.user.loginTime" />        <result property="status" column="applySettlementList.user.status" />        <result property="realName" column="applySettlementList.user.realName" />        <result property="IDCard" column="applySettlementList.user.IDCard" />        <result property="infoHeadImg" column="applySettlementList.user.infoHeadImg" />        <result property="locked" column="applySettlementList.user.locked" />        <result property="userSig" column="applySettlementList.user.userSig" />        <result property="birthday" column="applySettlementList.user.birthday" />        <result property="signinCount" column="applySettlementList.user.signinCount" />        <result property="applySettlementNoHandle" column="applySettlementList.user.applySettlementNoHandle" />        <result property="applySettlementRefuse" column="applySettlementList.user.applySettlementRefuse" />        <result property="applySettlementSum" column="applySettlementList.user.applySettlementSum" />        <association property="weixin"  javaType="Weixin" resultMap="WeixinMap"/>        <association property="attachment"  javaType="Attachment" resultMap="UserAttachmentMap"/>    </resultMap>    <!--Attachment映射-->    <resultMap id="ApplyAttachmentMap" type="Attachment">        <id property="id" column="applySettlementList.attachment.id" />        <result property="version" column="applySettlementList.attachment.version" />        <result property="datestr" column="applySettlementList.attachment.datestr" />        <result property="path" column="applySettlementList.attachment.path" />        <result property="name" column="applySettlementList.attachment.name" />        <result property="title" column="applySettlementList.attachment.title" />        <result property="type" column="applySettlementList.attachment.type" />        <result property="refID" column="applySettlementList.attachment.refID" />    </resultMap>    <!--ApplySettlement映射-->    <resultMap id="ApplySettlementMap" type="ApplySettlement">        <id property="id" column="applySettlementList.id" />        <result property="version" column="applySettlementList.version" />        <result property="applyPay" column="applySettlementList.applyPay" />        <result property="applyReason" column="applySettlementList.applyReason" />        <result property="userID" column="applySettlementList.userID" />        <result property="positionID" column="applySettlementList.positionID" />        <result property="handleOpinion" column="applySettlementList.handleOpinion" />        <result property="reason" column="applySettlementList.reason" />        <result property="workDate" column="applySettlementList.workDate" />        <result property="state" column="applySettlementList.state" />        <result property="positionWorkDate" column="applySettlementList.positionWorkDate" />        <result property="attachmentId" column="applySettlementList.attachmentId" />        <association property="user"  javaType="User" resultMap="UserMap"/>        <association property="attachment"  javaType="Attachment" resultMap="ApplyAttachmentMap"/>    </resultMap>    <!--Position映射-->    <resultMap id="PositionMap" type="Position">        <id property="id" column="id" />        <result property="version" column="version" />        <result property="title" column="title" />        <result property="salaryType" column="salaryType" />        <result property="recruitStartTime" column="recruitStartTime" />        <result property="recruitEndTime" column="recruitEndTime" />        <result property="salary" column="salary" />        <result property="dailySalary" column="dailySalary" />        <result property="liquidatedDamages" column="liquidatedDamages" />        <result property="recruitsSum" column="recruitsSum" />        <result property="sexRequirements" column="sexRequirements" />        <result property="workPalce" column="workPalce" />        <result property="workDate" column="workDate" />        <result property="aggregate" column="aggregate" />        <result property="setDate" column="setDate" />        <result property="contacts" column="contacts" />        <result property="contactNumber" column="contactNumber" />        <result property="settlement" column="settlement" />        <result property="matters" column="matters" />        <result property="jobRequirements" column="jobRequirements" />        <result property="jobContent" column="jobContent" />        <result property="includeBoard" column="includeBoard" />        <result property="controlSleep" column="controlSleep" />        <result property="interview" column="interview" />        <result property="baseTask" column="baseTask" />        <result property="commission" column="commission" />        <result property="train" column="train" />        <result property="beenRecruitedSum" column="beenRecruitedSum" />        <result property="workTypeID" column="workTypeID" />        <result property="userID" column="userID" />        <result property="open" column="open" />        <result property="type" column="type" />        <result property="startTime" column="startTime" />        <result property="endTime" column="endTime" />        <association property="workPlace"  javaType="Localtioninfo" resultMap="LocaltioninfoMap"/>        <association property="huntingtype"  javaType="Huntingtype" resultMap="HuntingtypeMap"/>        <collection property="applySettlementList" resultMap="ApplySettlementMap" />    </resultMap>    <!--对象的多级映射 mapList mapPage mapOne-->	<select id="getUserPositionWaitApplySettlementInfo" resultMap="PositionMap">        select        <include refid="detailList"/>		,(SELECT COUNT(*) FROM (SELECT * FROM signin GROUP BY DATE (signTime)) a WHERE a.userID = user.id		AND a.positionID = p.id ) AS "applySettlementList.user.signinCount"		,(SELECT COUNT(*) FROM applysettlement a WHERE a.positionID = p.id AND a.userID = user.id AND a.state = 0) AS "applySettlementList.user.applySettlementNoHandle"		,(SELECT COUNT(*) FROM applysettlement a WHERE a.positionID = p.id AND a.userID = user.id AND a.state = 2) AS "applySettlementList.user.applySettlementRefuse"		,(SELECT COUNT(*) FROM applysettlement a WHERE a.positionID = p.id AND a.userID = user.id ) AS "applySettlementList.user.applySettlementSum"        from  position p        left join localtioninfo workPlace on p.workPalce = workPlace.id        left join huntingtype huntingtype on p.workTypeID = huntingtype.id        left join applysettlement applySettlementList on p.id = applySettlementList.positionID        left join shiro_user user on applySettlementList.userID = user.id        left join attachment attachmentUser on user.infoHeadImg = attachmentUser.id        left join attachment attachmentApply on applySettlementList.attachmentId = attachmentApply.id        left join weixin weixin on user.id = weixin.userID		WHERE p.userID = #{condition.userID} AND p.open = #{condition.open} AND p.type = #{condition.type} AND		p.isDeleted = #{condition.isDeleted} AND applySettlementList.state = #{condition.state}	</select>    <!--级联查询-->    <sql id="detailList1">        a.id as 'id',        a.version as 'version',a.applyPay as 'applyPay',a.applyReason as 'applyReason',a.userID as 'userID',a.positionID as 'positionID',a.handleOpinion as 'handleOpinion',a.reason as 'reason',a.workDate as 'workDate',a.state as 'state',        user.id as 'user.id',        user.version as 'user.version',user.accountNo as 'user.accountNo',user.weChatNo as 'user.weChatNo',user.nickName as 'user.nickName',user.sex as 'user.sex',user.phoneNumber as 'user.phoneNumber',user.lastLoginTime as 'user.lastLoginTime',user.loginTime as 'user.loginTime',user.status as 'user.status',user.realName as 'user.realName',user.IDCard as 'user.IDCard',user.infoHeadImg as 'user.infoHeadImg',user.locked as 'user.locked',user.userSig as 'user.userSig',user.birthday as 'user.birthday',        attachment.id as 'user.attachment.id',        attachment.version as 'user.attachment.version',attachment.datestr as 'user.attachment.datestr',attachment.path as 'user.attachment.path',attachment.name as 'user.attachment.name',attachment.title as 'user.attachment.title',attachment.type as 'user.attachment.type',attachment.refID as 'user.attachment.refID',        weixin.headimgurl as 'user.weixin.headimgurl'     </sql>    <!--Weixin映射-->    <resultMap id="WeixinMap" type="Weixin">        <result property="headimgurl" column="user.weixin.headimgurl" />    </resultMap>    <!--Attachment映射-->    <resultMap id="AttachmentMap" type="Attachment">        <id property="id" column="user.attachment.id" />        <result property="version" column="user.attachment.version" />        <result property="datestr" column="user.attachment.datestr" />        <result property="path" column="user.attachment.path" />        <result property="name" column="user.attachment.name" />        <result property="title" column="user.attachment.title" />        <result property="type" column="user.attachment.type" />        <result property="refID" column="user.attachment.refID" />    </resultMap>    <!--User映射-->    <resultMap id="UserMap1" type="User">        <id property="id" column="user.id" />        <result property="version" column="user.version" />        <result property="accountNo" column="user.accountNo" />        <result property="password" column="user.password" />        <result property="weChatNo" column="user.weChatNo" />        <result property="nickName" column="user.nickName" />        <result property="sex" column="user.sex" />        <result property="phoneNumber" column="user.phoneNumber" />        <result property="lastLoginTime" column="user.lastLoginTime" />        <result property="loginTime" column="user.loginTime" />        <result property="status" column="user.status" />        <result property="realName" column="user.realName" />        <result property="IDCard" column="user.IDCard" />        <result property="infoHeadImg" column="user.infoHeadImg" />        <result property="locked" column="user.locked" />        <result property="userSig" column="user.userSig" />        <result property="birthday" column="user.birthday" />        <result property="applySettlementNoHandle" column="user.applySettlementNoHandle" />        <result property="applySettlementRefuse" column="user.applySettlementRefuse" />        <result property="applySettlementSum" column="user.applySettlementSum" />        <association property="weixin"  javaType="Weixin" resultMap="WeixinMap"/>        <association property="attachment"  javaType="Attachment" resultMap="AttachmentMap"/>    </resultMap>    <!--ApplySettlement映射-->    <resultMap id="ApplySettlementMap1" type="ApplySettlement">        <id property="id" column="id" />        <result property="version" column="version" />        <result property="applyPay" column="applyPay" />        <result property="applyReason" column="applyReason" />        <result property="userID" column="userID" />        <result property="positionID" column="positionID" />        <result property="handleOpinion" column="handleOpinion" />        <result property="reason" column="reason" />        <result property="workDate" column="workDate" />        <result property="state" column="state" />        <result property="positionWorkDate" column="positionWorkDate" />        <result property="attachmentId" column="attachmentId" />        <association property="user"  javaType="User" resultMap="UserMap1"/>    </resultMap>    <!--对象的多级映射 mapList mapPage mapOne-->    <select id="mapList" resultMap="ApplySettlementMap1" >        select        <include refid="detailList1"/>        from  applysettlement a        left join shiro_user user on a.userID = user.id        left join attachment attachment on user.infoHeadImg = attachment.id        left join weixin weixin on user.id = weixin.userID        <include refid="whereClause"/>        <if test="orderByClause!=null">${orderByClause}</if>    </select>    <!--级联查询-->    <sql id="signdetailList">    p.id as 'id',    p.version as 'version',p.title as 'title',p.salaryType as 'salaryType',p.recruitStartTime as 'recruitStartTime',p.recruitEndTime as 'recruitEndTime',p.salary as 'salary',p.dailySalary as 'dailySalary',p.liquidatedDamages as 'liquidatedDamages',p.recruitsSum as 'recruitsSum',p.sexRequirements as 'sexRequirements',p.workPalce as 'workPalce',p.workDate as 'workDate',p.aggregate as 'aggregate',p.setDate as 'setDate',p.contacts as 'contacts',p.contactNumber as 'contactNumber',p.settlement as 'settlement',p.matters as 'matters',p.jobRequirements as 'jobRequirements',p.jobContent as 'jobContent',p.includeBoard as 'includeBoard',p.controlSleep as 'controlSleep',p.interview as 'interview',p.baseTask as 'baseTask',p.commission as 'commission',p.train as 'train',p.workTypeID as 'workTypeID',p.userID as 'userID',p.open as 'open',p.type as 'type',p.startTime as 'startTime',p.endTime as 'endTime',p.publishTime as 'publishTime',    workPlace.id as 'workPlace.id',    workPlace.version as 'workPlace.version',workPlace.cityID as 'workPlace.cityID',workPlace.detailedAddress as 'workPlace.detailedAddress',workPlace.longitude as 'workPlace.longitude',workPlace.latitude as 'workPlace.latitude',workPlace.geohash as 'workPlace.geohash',    city.id as 'workPlace.city.id',    city.version as 'workPlace.city.version',city.pinyin as 'workPlace.city.pinyin',city.cityName as 'workPlace.city.cityName',city.zipCode as 'workPlace.city.zipCode',city.openState as 'workPlace.city.openState',city.cityType as 'workPlace.city.cityType',city.isHot as 'workPlace.city.isHot',    huntingtype.id as 'huntingtype.id',    huntingtype.version as 'huntingtype.version',huntingtype.name as 'huntingtype.name',huntingtype.HTFatCode as 'huntingtype.HTFatCode',huntingtype.state as 'huntingtype.state',huntingtype.codeGrade as 'huntingtype.codeGrade',    signins.id as 'signins.id',    signins.version as 'signins.version',signins.userID as 'signins.userID',signins.signAddress as 'signins.signAddress',signins.positionID as 'signins.positionID',signins.signTime as 'signins.signTime',signins.state as 'signins.state',signins.confirmationTime as 'signins.confirmationTime',signins.signinType as 'signins.signinType',signins.attachmentId as 'signins.attachmentId',    user.id as 'signins.user.id',    user.version as 'signins.user.version',user.accountNo as 'signins.user.accountNo',user.password as 'signins.user.password',user.weChatNo as 'signins.user.weChatNo',user.nickName as 'signins.user.nickName',user.sex as 'signins.user.sex',user.phoneNumber as 'signins.user.phoneNumber',user.lastLoginTime as 'signins.user.lastLoginTime',user.loginTime as 'signins.user.loginTime',user.status as 'signins.user.status',user.realName as 'signins.user.realName',user.IDCard as 'signins.user.IDCard',user.infoHeadImg as 'signins.user.infoHeadImg',user.locked as 'signins.user.locked',user.userSig as 'signins.user.userSig',user.birthday as 'signins.user.birthday',user.pinyin as 'signins.user.pinyin',    attachment.id as 'signins.user.attachment.id',    attachment.version as 'signins.user.attachment.version',attachment.datestr as 'signins.user.attachment.datestr',attachment.path as 'signins.user.attachment.path',attachment.name as 'signins.user.attachment.name',attachment.title as 'signins.user.attachment.title',attachment.type as 'signins.user.attachment.type',attachment.refID as 'signins.user.attachment.refID',    weixin.id as 'signins.user.weixin.id',    weixin.version as 'signins.user.weixin.version',weixin.nickname as 'signins.user.weixin.nickname',weixin.sex as 'signins.user.weixin.sex',weixin.province as 'signins.user.weixin.province',weixin.city as 'signins.user.weixin.city',weixin.country as 'signins.user.weixin.country',weixin.headimgurl as 'signins.user.weixin.headimgurl',weixin.privilegeStr as 'signins.user.weixin.privilegeStr',weixin.unionid as 'signins.user.weixin.unionid',weixin.openid as 'signins.user.weixin.openid',weixin.userID as 'signins.user.weixin.userID',weixin.refreshToken as 'signins.user.weixin.refreshToken',weixin.accessToken as 'signins.user.weixin.accessToken',weixin.refreshTokenTime as 'signins.user.weixin.refreshTokenTime',weixin.accessTokenTime as 'signins.user.weixin.accessTokenTime',weixin.ticket as 'signins.user.weixin.ticket',weixin.ticketTime as 'signins.user.weixin.ticketTime'    </sql>    <!--级联查询-->    <sql id="simplesigndetailList">        p.id as 'id',        p.version as 'version',p.title as 'title',p.salaryType as 'salaryType',p.recruitStartTime as 'recruitStartTime',p.recruitEndTime as 'recruitEndTime',p.salary as 'salary',p.dailySalary as 'dailySalary',p.liquidatedDamages as 'liquidatedDamages',p.recruitsSum as 'recruitsSum',p.sexRequirements as 'sexRequirements',p.workPalce as 'workPalce',p.workDate as 'workDate',p.aggregate as 'aggregate',p.setDate as 'setDate',p.contacts as 'contacts',p.contactNumber as 'contactNumber',p.settlement as 'settlement',p.matters as 'matters',p.jobRequirements as 'jobRequirements',p.jobContent as 'jobContent',p.includeBoard as 'includeBoard',p.controlSleep as 'controlSleep',p.interview as 'interview',p.baseTask as 'baseTask',p.commission as 'commission',p.train as 'train',p.beenRecruitedSum as 'beenRecruitedSum',p.workTypeID as 'workTypeID',p.userID as 'userID',p.open as 'open',p.type as 'type',p.startTime as 'startTime',p.endTime as 'endTime',p.publishTime as 'publishTime',        signins.id as 'signins.id',        signins.version as 'signins.version',signins.userID as 'signins.userID',signins.signAddress as 'signins.signAddress',signins.positionID as 'signins.positionID',signins.signTime as 'signins.signTime',signins.state as 'signins.state',signins.confirmationTime as 'signins.confirmationTime',signins.signinType as 'signins.signinType',signins.attachmentId as 'signins.attachmentId',        user.id as 'signins.user.id',        user.version as 'signins.user.version',user.accountNo as 'signins.user.accountNo',user.password as 'signins.user.password',user.weChatNo as 'signins.user.weChatNo',user.nickName as 'signins.user.nickName',user.sex as 'signins.user.sex',user.phoneNumber as 'signins.user.phoneNumber',user.lastLoginTime as 'signins.user.lastLoginTime',user.loginTime as 'signins.user.loginTime',user.status as 'signins.user.status',user.realName as 'signins.user.realName',user.IDCard as 'signins.user.IDCard',user.infoHeadImg as 'signins.user.infoHeadImg',user.locked as 'signins.user.locked',user.userSig as 'signins.user.userSig',user.birthday as 'signins.user.birthday',user.pinyin as 'signins.user.pinyin',        attachment.id as 'signins.user.attachment.id',        attachment.version as 'signins.user.attachment.version',attachment.datestr as 'signins.user.attachment.datestr',attachment.path as 'signins.user.attachment.path',attachment.name as 'signins.user.attachment.name',attachment.title as 'signins.user.attachment.title',attachment.type as 'signins.user.attachment.type',attachment.refID as 'signins.user.attachment.refID',        weixin.id as 'signins.user.weixin.id',        weixin.version as 'signins.user.weixin.version',weixin.nickname as 'signins.user.weixin.nickname',weixin.sex as 'signins.user.weixin.sex',weixin.province as 'signins.user.weixin.province',weixin.city as 'signins.user.weixin.city',weixin.country as 'signins.user.weixin.country',weixin.headimgurl as 'signins.user.weixin.headimgurl',weixin.privilegeStr as 'signins.user.weixin.privilegeStr',weixin.unionid as 'signins.user.weixin.unionid',weixin.openid as 'signins.user.weixin.openid',weixin.userID as 'signins.user.weixin.userID',weixin.refreshToken as 'signins.user.weixin.refreshToken',weixin.accessToken as 'signins.user.weixin.accessToken',weixin.refreshTokenTime as 'signins.user.weixin.refreshTokenTime',weixin.accessTokenTime as 'signins.user.weixin.accessTokenTime',weixin.ticket as 'signins.user.weixin.ticket',weixin.ticketTime as 'signins.user.weixin.ticketTime'    </sql>    <!--City映射-->    <resultMap id="getPositionCityMap" type="City">        <id property="id" column="workPlace.city.id"/>        <result property="version" column="workPlace.city.version"/>        <result property="pinyin" column="workPlace.city.pinyin"/>        <result property="cityName" column="workPlace.city.cityName"/>        <result property="zipCode" column="workPlace.city.zipCode"/>        <result property="openState" column="workPlace.city.openState"/>        <result property="cityType" column="workPlace.city.cityType"/>        <result property="isHot" column="workPlace.city.isHot"/>    </resultMap>    <!--signLocaltioninfo映射-->    <resultMap id="signLocaltioninfoMap" type="Localtioninfo">        <id property="id" column="workPlace.id" />        <result property="version" column="workPlace.version" />        <result property="cityID" column="workPlace.cityID" />        <result property="detailedAddress" column="workPlace.detailedAddress" />        <result property="longitude" column="workPlace.longitude" />        <result property="latitude" column="workPlace.latitude" />        <result property="geohash" column="workPlace.geohash" />        <association property="city" javaType="City" resultMap="getPositionCityMap"/>    </resultMap>    <!--signHuntingtype映射-->    <resultMap id="signHuntingtypeMap" type="Huntingtype">        <id property="id" column="huntingtype.id" />        <result property="version" column="huntingtype.version" />        <result property="name" column="huntingtype.name" />        <result property="HTFatCode" column="huntingtype.HTFatCode" />        <result property="state" column="huntingtype.state" />        <result property="codeGrade" column="huntingtype.codeGrade" />    </resultMap>    <!--signAttachment映射-->    <resultMap id="signAttachmentMap" type="Attachment">        <id property="id" column="signins.user.attachment.id" />        <result property="version" column="signins.user.attachment.version" />        <result property="datestr" column="signins.user.attachment.datestr" />        <result property="path" column="signins.user.attachment.path" />        <result property="name" column="signins.user.attachment.name" />        <result property="title" column="signins.user.attachment.title" />        <result property="type" column="signins.user.attachment.type" />        <result property="refID" column="signins.user.attachment.refID" />    </resultMap>    <!--signWeixin映射-->    <resultMap id="signWeixinMap" type="Weixin">        <id property="id" column="signins.user.weixin.id" />        <result property="version" column="signins.user.weixin.version" />        <result property="nickname" column="signins.user.weixin.nickname" />        <result property="sex" column="signins.user.weixin.sex" />        <result property="province" column="signins.user.weixin.province" />        <result property="city" column="signins.user.weixin.city" />        <result property="country" column="signins.user.weixin.country" />        <result property="headimgurl" column="signins.user.weixin.headimgurl" />        <result property="privilegeStr" column="signins.user.weixin.privilegeStr" />        <result property="unionid" column="signins.user.weixin.unionid" />        <result property="openid" column="signins.user.weixin.openid" />        <result property="userID" column="signins.user.weixin.userID" />        <result property="refreshToken" column="signins.user.weixin.refreshToken" />        <result property="accessToken" column="signins.user.weixin.accessToken" />        <result property="refreshTokenTime" column="signins.user.weixin.refreshTokenTime" />        <result property="accessTokenTime" column="signins.user.weixin.accessTokenTime" />        <result property="ticket" column="signins.user.weixin.ticket" />        <result property="ticketTime" column="signins.user.weixin.ticketTime" />    </resultMap>    <!--signUser映射-->    <resultMap id="signUserMap" type="User">        <id property="id" column="signins.user.id" />        <result property="version" column="signins.user.version" />        <result property="accountNo" column="signins.user.accountNo" />        <result property="password" column="signins.user.password" />        <result property="weChatNo" column="signins.user.weChatNo" />        <result property="nickName" column="signins.user.nickName" />        <result property="sex" column="signins.user.sex" />        <result property="phoneNumber" column="signins.user.phoneNumber" />        <result property="lastLoginTime" column="signins.user.lastLoginTime" />        <result property="loginTime" column="signins.user.loginTime" />        <result property="status" column="signins.user.status" />        <result property="realName" column="signins.user.realName" />        <result property="IDCard" column="signins.user.IDCard" />        <result property="infoHeadImg" column="signins.user.infoHeadImg" />        <result property="locked" column="signins.user.locked" />        <result property="userSig" column="signins.user.userSig" />        <result property="birthday" column="signins.user.birthday" />        <result property="pinyin" column="signins.user.pinyin" />        <association property="attachment"  javaType="Attachment" resultMap="signAttachmentMap"/>        <association property="weixin"  javaType="Weixin" resultMap="signWeixinMap"/>    </resultMap>    <!--signSignin映射-->    <resultMap id="signSigninMap" type="Signin">        <id property="id" column="signins.id" />        <result property="version" column="signins.version" />        <result property="userID" column="signins.userID" />        <result property="signAddress" column="signins.signAddress" />        <result property="positionID" column="signins.positionID" />        <result property="signTime" column="signins.signTime" />        <result property="state" column="signins.state" />        <result property="confirmationTime" column="signins.confirmationTime" />        <result property="signinType" column="signins.signinType" />        <result property="attachmentId" column="signins.attachmentId" />        <result property="num" column="signins.num" />        <result property="hasUrge" column="signins.hasUrge" />        <result property="ids" column="signins.ids" />        <association property="user"  javaType="User" resultMap="signUserMap"/>    </resultMap>    <!--signPosition映射-->    <resultMap id="signPositionMap" type="Position">        <id property="id" column="id" />        <result property="version" column="version" />        <result property="title" column="title" />        <result property="salaryType" column="salaryType" />        <result property="recruitStartTime" column="recruitStartTime" />        <result property="recruitEndTime" column="recruitEndTime" />        <result property="salary" column="salary" />        <result property="dailySalary" column="dailySalary" />        <result property="liquidatedDamages" column="liquidatedDamages" />        <result property="recruitsSum" column="recruitsSum" />        <result property="sexRequirements" column="sexRequirements" />        <result property="workPalce" column="workPalce" />        <result property="workDate" column="workDate" />        <result property="aggregate" column="aggregate" />        <result property="setDate" column="setDate" />        <result property="contacts" column="contacts" />        <result property="contactNumber" column="contactNumber" />        <result property="settlement" column="settlement" />        <result property="matters" column="matters" />        <result property="jobRequirements" column="jobRequirements" />        <result property="jobContent" column="jobContent" />        <result property="includeBoard" column="includeBoard" />        <result property="controlSleep" column="controlSleep" />        <result property="interview" column="interview" />        <result property="baseTask" column="baseTask" />        <result property="commission" column="commission" />        <result property="train" column="train" />        <result property="beenRecruitedSum" column="beenRecruitedSum" />        <result property="workTypeID" column="workTypeID" />        <result property="userID" column="userID" />        <result property="open" column="open" />        <result property="type" column="type" />        <result property="startTime" column="startTime" />        <result property="endTime" column="endTime" />        <result property="publishTime" column="publishTime" />        <result property="personNumDay" column="personNumDay" />        <association property="workPlace"  javaType="Localtioninfo" resultMap="signLocaltioninfoMap"/>        <association property="huntingtype"  javaType="Huntingtype" resultMap="signHuntingtypeMap"/>        <collection property="signins" resultMap="signSigninMap" />    </resultMap>    <!--对象的多级映射 mapList mapPage mapOne-->    <select id="signmapList" resultMap="signPositionMap" >        select * from (select        <include refid="signdetailList"/>        ,  p.personNumDay as 'personNumDay'        , (select case when count(apl.id) >0 then true else false end  from applysettlement apl where apl.userID =  signins.userID and apl.positionID = p.id and apl.isDeleted = false and apl.state = 3 )as 'signins.hasUrge'        , count( distinct  signins.id )  as 'signins.num'        , (SELECT COUNT(1) FROM beenrecruited where beenrecruited.positionID = p.id AND beenrecruited.dismiss IS NULL AND beenrecruited.state &gt; 1) AS 'beenRecruitedSum'        from  position p        left join localtioninfo workPlace on p.workPalce = workPlace.id        LEFT JOIN city city ON workPlace.cityID = city.id        left join huntingtype huntingtype on p.workTypeID = huntingtype.id        left join signin signins on p.id = signins.positionID        left join shiro_user user on signins.userID = user.id        left join attachment attachment on user.infoHeadImg = attachment.id        left join weixin weixin on user.id = weixin.userID        WHERE p.userID = #{condition.userID}        <if test="condition.open!=null">            AND p.open = #{condition.open}        </if>        AND p.type = #{condition.type} AND p.isDeleted = #{condition.isDeleted} AND signins.state = #{condition.state}        <if test="orderByClause!=null">${orderByClause}</if>        group by p.`id`,signins.userID order by signins.createTime desc)as  temp group by id order by publishTime desc    </select>    <!--对象的多级映射 mapList mapPage mapOne-->    <select id="simpleSignList" resultMap="signPositionMap" >        select        <include refid="simplesigndetailList"/>        ,(select case when count(apl.id) >0 then true else false end  from applysettlement apl where apl.userID =  signins.userID and apl.positionID = p.id and apl.isDeleted = false and apl.state = 3 )as 'signins.hasUrge'        , count( distinct  signins.id )  as 'signins.num'        , group_concat(signins.id Separator ',') as 'signins.ids'        from  position p        left join signin signins on p.id = signins.positionID        left join shiro_user user on signins.userID = user.id        left join attachment attachment on user.infoHeadImg = attachment.id        left join weixin weixin on user.id = weixin.userID        WHERE 1=1        <if test="condition.workDate!=null">            AND DATE(signins.createTime) in (${condition.workDate})        </if>        AND signins.state = #{condition.state} AND  p.id= #{condition.positionID}        <if test="orderByClause!=null">${orderByClause}</if>        group by signins.userID    </select>    <!--对象的多级映射 mapList mapPage mapOne-->    <select id="historyPosition" resultMap="signPositionMap" >        SELECT * FROM (SELECT        <include refid="signdetailList"/>        ,  p.personNumDay AS 'personNumDay'        , (SELECT CASE WHEN COUNT(apl.id) >0 THEN TRUE ELSE FALSE END  FROM applysettlement apl WHERE apl.userID =  signins.userID AND apl.positionID = p.id AND apl.isDeleted = FALSE AND apl.state = 3 )AS 'signins.hasUrge'        , COUNT( DISTINCT  signins.id )  AS 'signins.num'        , (SELECT COUNT(1) FROM beenrecruited WHERE beenrecruited.positionID = p.id AND beenrecruited.dismiss IS NULL AND beenrecruited.state &gt; 1) AS 'beenRecruitedSum'        FROM  POSITION p        LEFT JOIN localtioninfo workPlace ON p.workPalce = workPlace.id        LEFT JOIN city city ON workPlace.cityID = city.id        LEFT JOIN huntingtype huntingtype ON p.workTypeID = huntingtype.id        LEFT JOIN signin signins ON p.id = signins.positionID        LEFT JOIN shiro_user USER ON signins.userID = user.id        LEFT JOIN attachment attachment ON user.infoHeadImg = attachment.id        LEFT JOIN weixin weixin ON user.id = weixin.userID        WHERE p.userID = #{condition.userID}        <if test="condition.open!=null">            AND p.open = #{condition.open}        </if>        <if test="condition.isDeleted!=null">            AND p.isDeleted = #{condition.isDeleted}        </if>        AND p.type = #{condition.type}        <if test="condition.state!=null">            AND signins.state = #{condition.state}        </if>        <if test="ids!=null">            <if test="ids.size>0">                AND ( p.open IN                <foreach item="items" index="index" collection="ids" open="(" separator="," close=")">                    #{items}                </foreach>                OR p.isDeleted = TRUE)            </if>        </if>        <if test="orderByClause!=null">${orderByClause}</if>        GROUP BY p.`id`,signins.userID ORDER BY signins.createTime DESC)AS  temp GROUP BY id ORDER BY publishTime DESC    </select></mapper>